"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[419],{86654:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("a-row",{attrs:{gutter:20}},[a("a-col",{attrs:{span:4}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){e.addCateVisible=!0}}},[e._v("新增分类")])],1)],1),a("a-table",{attrs:{rowKey:"id",columns:e.columns,pagination:e.pagination,dataSource:e.Catelist,bordered:""},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"action",fn:function(t){return[a("div",{staticClass:"actionSlot"},[a("a-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary",icon:"edit"},on:{click:function(a){return e.editCate(t.id)}}},[e._v("编辑")]),a("a-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"danger",icon:"delete"},on:{click:function(a){return e.deleteCate(t.id)}}},[e._v("删除")])],1)]}}])})],1),a("a-modal",{attrs:{closable:"",title:"新增分类",visible:e.addCateVisible,width:"60%",destroyOnClose:""},on:{ok:e.addCateOk,cancel:e.addCateCancel}},[a("a-form-model",{ref:"addCategoryRef",attrs:{model:e.newCate,rules:e.addCateRules}},[a("a-form-model-item",{attrs:{label:"分类名称",prop:"name"}},[a("a-input",{model:{value:e.newCate.name,callback:function(t){e.$set(e.newCate,"name",t)},expression:"newCate.name"}})],1)],1)],1),a("a-modal",{attrs:{closable:"",destroyOnClose:"",title:"编辑分类",visible:e.editCateVisible,width:"60%"},on:{ok:e.editCateOk,cancel:e.editCateCancel}},[a("a-form-model",{ref:"addCategoryRef",attrs:{model:e.CateInfo,rules:e.CateRules}},[a("a-form-model-item",{attrs:{label:"分类名称",prop:"name"}},[a("a-input",{model:{value:e.CateInfo.name,callback:function(t){e.$set(e.CateInfo,"name",t)},expression:"CateInfo.name"}})],1)],1)],1)],1)},s=[];const n=[{title:"ID",dataIndex:"id",width:"10%",key:"id",align:"center"},{title:"分类名",dataIndex:"name",width:"20%",key:"name",align:"center"},{title:"操作",width:"30%",key:"action",align:"center",scopedSlots:{customRender:"action"}}];var r={data(){return{pagination:{pageSizeOptions:["5","10","20"],pageSize:5,total:0,showSizeChanger:!0,showTotal:e=>`共${e}条`},Catelist:[],CateInfo:{name:"",id:0},newCate:{name:""},columns:n,queryParam:{pagesize:5,pagenum:1},editVisible:!1,CateRules:{name:[{validator:(e,t,a)=>{""===this.CateInfo.name?a(new Error("请输入分类名")):a()},trigger:"blur"}]},addCateRules:{name:[{validator:(e,t,a)=>{""===this.newCate.name?a(new Error("请输入分类名")):a()},trigger:"blur"}]},editCateVisible:!1,addCateVisible:!1}},created(){this.getCateList()},methods:{async getCateList(){const{data:e}=await this.$http.get("category",{pagesize:this.queryParam.pagesize,pagenum:this.queryParam.pagenum});200!==e.status&&(e.status,window.sessionStorage.clear(),this.$router.push("/login"),this.$message.error(e.msg)),this.Catelist=e.data,this.pagination.total=e.total},handleTableChange(e,t,a){var i={...this.pagination};i.current=e.current,i.pageSize=e.pageSize,this.queryParam.pagesize=e.pageSize,this.queryParam.pagenum=e.current,e.pageSize!==this.pagination.pageSize&&(this.queryParam.pagenum=1,i.current=1),this.pagination=i,this.getCateList()},deleteCate(e){this.$confirm({title:"提示：请再次确认",content:"确定要删除该分类吗？一旦删除，无法恢复",onOk:async()=>{const{data:t}=await this.$http.delete(`category/${e}`);if(200!=t.status)return this.$message.error(t.msg);this.$message.success("删除成功"),this.getCateList()},onCancel:()=>{this.$message.info("已取消删除")}})},addCateOk(){this.$refs.addCategoryRef.validate((async e=>{if(!e)return this.$message.error("参数不符合要求，请重新输入");const{data:t}=await this.$http.post("category/add",{name:this.newCate.name});if(200!=t.status)return this.$message.error(t.msg);this.$refs.addCategoryRef.resetFields(),this.addCateVisible=!1,this.$message.success("添加分类成功"),await this.getCateList()}))},addCateCancel(){this.$refs.addCategoryRef.resetFields(),this.addCateVisible=!1,this.$message.info("新增分类已取消")},async editCate(e){this.editCateVisible=!0;const{data:t}=await this.$http.get(`category/${e}`);this.CateInfo=t.data,this.CateInfo.id=e},editCateOk(){this.$refs.addCategoryRef.validate((async e=>{if(!e)return this.$message.error("参数不符合要求，请重新输入");const{data:t}=await this.$http.put(`category/${this.CateInfo.id}`,{name:this.CateInfo.name});if(200!=t.status)return this.$message.error(t.msg);this.editCateVisible=!1,this.$message.success("更新分类信息成功"),this.getCateList()}))},editCateCancel(){this.$refs.addCategoryRef.resetFields(),this.editCateVisible=!1,this.$message.info("编辑已取消")}}},o=r,d=a(1001),l=(0,d.Z)(o,i,s,!1,null,"bbaaf49c",null),c=l.exports}}]);
//# sourceMappingURL=CateList.e9a54fb6.js.map